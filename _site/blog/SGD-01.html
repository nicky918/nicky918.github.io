<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="aexITLS38FdIRzwj25OVWxm87rpa9l-UV0URTyC9cTs" />
  <title>
    机器学习：随机梯度下降法
    
  </title>
  <link rel="stylesheet" href="../css/site.css">
  <link href="//cdn.bootcss.com/font-awesome/4.4.0/css/font-awesome.css" rel="stylesheet">
  <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
  
  <link rel="alternate" type="application/atom+xml" title="RSS Feed for Vista's blog" href="/feed.xml" />

  

  

  
</head>

<body>
  <div class="header-container">
    <header class="inner">
      
      <nav>
        <a class="" href="/">About</a>
        <a class="" href="/project/">Project</a>
        <!--<a class="" href="/resume/">Resume</a>
	      <a href="/yuanyong_resume_cn.pdf">Resume</a>
	      <a href="/YongYuan_resume.pdf">Resume</a>
        <a class="" href="/publication/">Publication</a>-->
        <a class="" href="/blog/">Blog</a>
	      <a href="/books/">Book</a>
		    <a href="/timeline/">Times</a>
        <a href="http://git.oschina.net/vista918">oschina</a>
        <a href="https://github.com/nicky918">github(少用)</a>
      </nav>
	  

      <div class="pull-right right logo">
        <!--<div class="name">
          <a href="/">Yong Yuan</a><br />
          <small>
            <em>
              
                <a href="/">developer</a>
              
            </em>
          </small>
        </div>-->
        <a href="https://nicky918.github.io/"><img class="avatar" src="/images/vista.jpg" alt="My profile picture" /></a>
      </div>
      <div class="clear"></div>
    </header>
    <div class="clear"></div>
  </div>

  <link rel="stylesheet" href="../css/blog.css">



<div id="container">
<article>
<div class="inner">
<div class = "post-header">
  <h1>
    机器学习：随机梯度下降法
  </h1>
  <ul class="meta">
  	<i class="fa fa-calendar"></i>
  	2017年06月17日
  	<i class="space"></i>
  	<i class="fa fa-archive"></i>
  	<a class="tag" href="http://localhost:4000/blog/categories.html#机器学习">机器学习</a>
  	<i class="space"></i>
  	<i class="fa fa-tags"></i>
  	
  	    <a class="tag" href="http://localhost:4000/tag/#机器学习">机器学习</a>
  	    <i class="space"></i>
  	
  	<i class="space"></i> 字数:1109
  </ul>
</div>
</div>

  <div class="post">
        <div id="content">
          <div class ="sidebox">
              <div class ="sidebar">
              <div class="toc"></div>
              </div>
          </div>
  	   <blockquote>
  <p>随机梯度下降算法(Stochastic Gradient Descent, SGD)</p>
</blockquote>

<h2 id="引">引</h2>

<p>大学时我们学过怎样求函数的极值。函数$y=f(x)$的极值点，$f’(x)=0$就是它的导数的那个点。因此我们可以通过解方程$f’(x)=0$，求得函数的极值点$(x_0,y_0)$。</p>

<p>不过对于计算机来说，它可不会解方程。但是它可以凭借强大的计算能力，一步一步的去把函数的极值点『试』出来。如下图所示：</p>

<p><img src="../images/posts/2017/SGD-1.png" alt="" /></p>

<p>首先，我们随便选择一个点开始，比如上图的$x_0$点。接下来，每次迭代修改$x$值为$x_1,x_2,…$，经过数次迭代后最终达到函数最小值点。</p>

<p>你可能要问了，为啥每次修改$x$的值，都能往函数最小值那个方向前进呢？这里的奥秘在于，我们每次都是向函数$y=f(x)$的<code class="highlighter-rouge">梯度的相反方向</code>来修改$x$。什么是<code class="highlighter-rouge">梯度</code>呢？翻开大学高数课的课本，我们会发现梯度是一个向量，它指向函数值上升最快的方向。显然，梯度的反方向当然就是函数值下降最快的方向了。我们每次沿着梯度相反方向去修改的值，当然就能走到函数的最小值附近。之所以是最小值附近而不是最小值那个点，是因为我们每次移动的步长不会那么恰到好处，有可能最后一次迭代走远了越过了最小值那个点。步长的选择是门手艺，如果选择小了，那么就会迭代很多轮才能走到最小值附近；如果选择大了，那可能就会越过最小值很远，收敛不到一个好的点上。</p>

<p>按照上面的讨论，我们就可以写出梯度下降算法的公式</p>

<p><script type="math/tex">x_{new} = x_{old} - \eta\nabla f(x)</script>
其中，$\nabla$是<em>梯度算子</em>，$\nabla f(x)$就是指$f(x)$的<em>梯度</em>。$\eta$是步长，也称作<em>学习速率</em>。</p>

<p><strong>**省略部分</strong>**</p>

<p>推导出权值修改的梯度下降公式</p>

<script type="math/tex; mode=display">W_{new} = W_{old} + \eta\sum_{i=1}^n(y^{(i)} - \bar{y}^{(i)})X^{(i)}</script>

<p>需要说明的是，如果每个样本有M个特征，则上式中的$X,W$都是<code class="highlighter-rouge">M+1维</code>向量(因为我们加上了一个恒为1的虚拟特征$x_0$，参考前面的内容，而是$y$标量。用高逼格的数学符号表示，就是
<script type="math/tex">X,W \in\Re^(M+1)</script>
<script type="math/tex">y\in\Re^1</script></p>

<h2 id="随机梯度下降算法stochastic-gradient-descent-sgd">随机梯度下降算法(Stochastic Gradient Descent, SGD)</h2>

<p>如果我们根据上面推导出的公式来训练模型，那么我们每次更新<code class="highlighter-rouge">W</code>的迭代，要遍历训练数据中所有的样本进行计算，我们称这种算法叫做批梯度下降(<strong>Batch Gradient Descent</strong>)。如果我们的样本非常大，比如数百万到数亿，那么计算量异常巨大。因此，实用的算法是<code class="highlighter-rouge">SGD</code>算法。在<code class="highlighter-rouge">SGD</code>算法中，每次更新的迭代，只计算一个样本。这样对于一个具有数百万样本的训练数据，完成一次遍历就会对<code class="highlighter-rouge">W</code>更新数百万次，效率大大提升。由于样本的噪音和随机性，每次更新并不一定按照减少的方向。然而，虽然存在一定随机性，大量的更新总体上沿着减少<code class="highlighter-rouge">E</code>的方向前进的，因此最后也能收敛到最小值附近。
最后需要说明的是，SGD不仅仅效率高，而且随机性有时候反而是好事。今天的目标函数是一个『凸函数』，沿着梯度反方向就能找到全局唯一的最小值。然而对于非凸函数来说，存在许多局部最小值。随机性有助于我们逃离某些很糟糕的局部最小值，从而获得一个更好的模型。</p>

<h2 id="引用">引用</h2>

<ol>
  <li>https://www.zybuluo.com/hanbingtao/note/448086</li>
</ol>

  	</div>
	</div>
</article>

<!--翻页功能-->
<section class="inner">
<ul class="pager">
    
    <li class="previous">
       <a href="/blog/xcode.html">←Xcode：使用小结</a>
    </li>
    
    
    <li class="next">
    	<a href="/blog/back-propagtion.html">机器学习：一步步教你理解反向传播方法→</a>
    </li>
    
 </ul>
</section>

<!--评论功能-->
<!-- Disqus Comment BEGIN -->
<!--
<section class="comments inner duoshuo">
  <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'yongyuan'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
-->
<!-- Disqus Comment END -->

</section>
</div>

<script type="text/javascript"
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    <!--displayMath: [['$$','$$'], ['\[','\]']],-->
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    // Fix <code> tags after MathJax finishes running. This is a
    // hack to overcome a shortcoming of Markdown. Discussion at
    // https://github.com/mojombo/jekyll/issues/199
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>



  <!--<div class="separator"></div>-->

  <footer>
    <div  style="border-bottom: 1px solid #eee"></div>
    <p class="linkings">
        <a href="http://www.pyimagesearch.com/">pyimagesearch</a>&nbsp&nbsp&nbsp&nbsp<a href="http://bean.logdown.com/">bean</a>&nbsp&nbsp&nbsp&nbsp<a href="http://ml.memect.com/">ml dairy</a>&nbsp&nbsp&nbsp&nbsp<a href="http://rogerioferis.com/VisualRecognitionAndSearch2014/Resources.html/">Resources</a>
    </p>
    <p class="linkings">
        Utils: <a href="http://rogerioferis.com/VisualRecognitionAndSearch2014/Resources.html">rogerioferis</a>&nbsp&nbsp&nbsp&nbsp<a href="http://caffe.berkeleyvision.org/">Caffe</a>&nbsp&nbsp&nbsp&nbsp<a href="http://scikit-learn.org/stable/index.html">scikit-learn</a>&nbsp&nbsp&nbsp&nbsp<a href="http://www.astroml.org/index.html">AstroML</a></a>&nbsp&nbsp&nbsp&nbsp<a href="http://scikit-image.org/">scikit-image</a></a>&nbsp&nbsp&nbsp&nbsp<a href="http://gitxiv.com/">GitXiv</a>
    </p>
    <p>
      Made with <a href="http://jekyllrb.com/">Jekyll</a>(<a href="http://jekyll.com.cn/">中文</a>),
      hosted on <a href="https://github.com/nicky918/nicky918.github.io">Github Pages</a>. Inspired by <a href="http://sebastien.saunier.me/">saunier</a>, designed by <a href="https://nicky918.github.io/">vista</a>.
    </p>
    </p>
      <a href="http://www.easycounter.com/"><img src="http://www.easycounter.com/counter.php?vista"border="0" alt="Website Hit Counter"></a> since August 2013.
    </p>
    <ul class="links">
    </ul>
  </footer>

<script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>

</body>
</html>
